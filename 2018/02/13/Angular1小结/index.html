<!DOCTYPE html><html><head><meta charset="utf-8"><meta name="X-UA-Compatible" content="IE=edge"><title> Angular1小结 · CDBlog</title><meta name="description" content="Angular1小结 - chendong"><meta name="viewport" content="width=device-width, initial-scale=1"><link rel="icon" href="/favicon.png"><link rel="stylesheet" href="/css/apollo.css"><link rel="search" type="application/opensearchdescription+xml" href="http://yoursite.com/atom.xml" title="CDBlog"></head><body><div class="wrap"><header><a href="/" class="logo-link"><img src="/favicon.png" alt="logo"></a><ul class="nav nav-list"><li class="nav-list-item"><a href="/" target="_self" class="nav-list-link">BLOG</a></li><li class="nav-list-item"><a href="/archives/" target="_self" class="nav-list-link">ARCHIVE</a></li><li class="nav-list-item"><a href="/atom.xml" target="_self" class="nav-list-link">RSS</a></li></ul></header><main class="container"><div class="post"><article class="post-block"><h1 class="post-title">Angular1小结</h1><div class="post-info">Feb 13, 2018</div><div class="post-content"><h3 id="filter"><a href="#filter" class="headerlink" title="filter"></a>filter</h3><p>定义过滤器，返回一个filter function，在指令模板下可以进行一些筛选操作。<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">angular.module(&apos;filterModule&apos;)</span><br><span class="line">    .filter(&apos;fileSize&apos;, function () &#123;</span><br><span class="line">      return function (value) &#123;</span><br><span class="line">        var bytes = parseInt(value, 10);</span><br><span class="line">        var byteLabel = bytes &gt; 1 ? &apos;Bytes&apos; : &apos;Byte&apos;;</span><br><span class="line">        var sizes = [byteLabel, &apos;KB&apos;, &apos;MB&apos;, &apos;GB&apos;, &apos;TB&apos;];</span><br><span class="line">        var i = parseInt(Math.floor(Math.log(bytes) / Math.log(1024)));</span><br><span class="line">        return Math.round(bytes / Math.pow(1024, i), 2) + &apos; &apos; + sizes[i];</span><br><span class="line">      &#125;;</span><br><span class="line">    &#125;);</span><br></pre></td></tr></table></figure></p>
<hr>
<h3 id="factory-service"><a href="#factory-service" class="headerlink" title="factory service"></a>factory service</h3><p>factory service 都可以提供 xhr 服务，功用类似。<br>区别在于factory是返回一个实例对象， 而service是将服务绑定在this上的。<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">angular.module(&apos;httpModule&apos;)</span><br><span class="line">    .factory(&apos;api&apos;, function($http, $q)&#123;</span><br><span class="line">        var api = &#123;&#125;;</span><br><span class="line">        api.func1 = function()&#123;&#125;</span><br><span class="line">        api.func2 = function()&#123;&#125;</span><br><span class="line"></span><br><span class="line">        return api;</span><br><span class="line">    &#125;)</span><br><span class="line"></span><br><span class="line">angular.module(&apos;httpModule&apos;)</span><br><span class="line">    .service(&apos;api&apos;, function($http, $q)&#123;</span><br><span class="line">        var self = this;</span><br><span class="line">        self.func1 = function()&#123;&#125;</span><br><span class="line">        self.func2 = function()&#123;&#125;</span><br><span class="line">    &#125;)</span><br></pre></td></tr></table></figure></p>
<hr>
<a id="more"></a>
<h3 id="directive"><a href="#directive" class="headerlink" title="directive"></a>directive</h3><p>指令一般用于html和dom的操作。<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">angular.module(&apos;tabDirectives&apos;, [])</span><br><span class="line">  .directive(&apos;showTab&apos;,</span><br><span class="line">    function () &#123;</span><br><span class="line">      return &#123;</span><br><span class="line">      //  restrict: &apos;ACE&apos;,</span><br><span class="line">      //  template: &apos;&apos;,  </span><br><span class="line">      //  templateUrl: &apos;&apos;,</span><br><span class="line">        link: function (scope, element) &#123;</span><br><span class="line">          element.click(function(e) &#123;</span><br><span class="line">            e.preventDefault();</span><br><span class="line">            $(element).tab(&apos;show&apos;);</span><br><span class="line">          &#125;);</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;;</span><br><span class="line">    &#125;</span><br><span class="line">  );</span><br></pre></td></tr></table></figure></p>
<h4 id="指令中scope"><a href="#指令中scope" class="headerlink" title="指令中scope"></a>指令中scope</h4><ul>
<li>scope=false， 默认指令共享父的scope，两者改变数据，双向更改。</li>
<li>scope=true，指令初始化时继承父scope的数据，指令中scope改变之前，仍然将继承父scope的数据，但当指令中数据改变后，scope将是孤岛scope，与父scope地址分离。</li>
<li><p>scope={}，自定义scope，初始化一个scope对象，与父scope分离，提供了3种属性初始化方式。</p>
<ul>
<li>@ ：单项prop设置，将父scope传递到指令中</li>
<li>= ：与父scope双向绑定</li>
<li>&amp; ：指向父scope中的function</li>
</ul>
<hr>
</li>
</ul>
<h3 id="ngRoute"><a href="#ngRoute" class="headerlink" title="ngRoute"></a>ngRoute</h3><p>$routeProvider提供ngRoute服务，<code>.when</code>进行url匹配，指定模板url和controller，otherwise是前面没匹配到最后执行的， 类似switch的default，resolve是在切换前进行执行，data用于参数传递。<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line">angular.module(&apos;app&apos;, [&apos;ngRoute&apos;])</span><br><span class="line">    .config(function($routeProvider, $locationProvider) &#123;</span><br><span class="line"></span><br><span class="line">    $locationProvider.html5Mode(true);  //开启html5模式</span><br><span class="line">    //路由匹配</span><br><span class="line">    $routeProvider</span><br><span class="line">    .when(&apos;/page1&apos;, &#123;  </span><br><span class="line">        templateUrl: &apos;page1.tpl.html&apos;,  </span><br><span class="line">        controller: &apos;page1Controller&apos;  </span><br><span class="line">    &#125;)  </span><br><span class="line">    .when(&apos;/page/:id, &#123;</span><br><span class="line">        templateUrl: &apos;page.tpl.html&apos;,  </span><br><span class="line">        controller: &apos;pageController&apos; </span><br><span class="line">    &#125;)</span><br><span class="line">    .otherwise(&#123;</span><br><span class="line">      templateUrl: &apos;app.tpl.html&apos;,</span><br><span class="line">      controller: &apos;appController&apos;,</span><br><span class="line">      resolve: &#123;</span><br><span class="line">        myVar: function(authService) &#123;</span><br><span class="line">          return authService.init();</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;,</span><br><span class="line">      data: &#123;</span><br><span class="line">        authorizedRoles: [&apos;admin&apos;, &apos;creator&apos;, &apos;manager&apos;, &apos;guest&apos;]</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;);</span><br><span class="line">    &#125;</span><br><span class="line">    .run( function ($rootScope, $window, $location, $log) &#123;  </span><br><span class="line">        // 监听路由更改事件</span><br><span class="line">        $rootScope.$on(&apos;$routeChangeStart&apos;, function (event, current, previous) &#123;</span><br><span class="line">        if(current.$$route &amp;&amp; current.$$route.data) &#123;</span><br><span class="line">            var authorizedRoles = current.$$route.data.authorizedRoles;</span><br><span class="line">            $rootScope.notAuthorized = !authService.isAuthorized(authorizedRoles);</span><br><span class="line">        &#125;</span><br><span class="line">      );  </span><br><span class="line">    </span><br><span class="line">        $rootScope.$on(&apos;$routeChangeSuccess&apos;, function() &#123; &#125;); </span><br><span class="line">    &#125;)</span><br></pre></td></tr></table></figure></p>
<hr>
<h3 id="digest-apply-scope-rootScope"><a href="#digest-apply-scope-rootScope" class="headerlink" title="$digest $apply $scope $rootScope"></a>$digest $apply $scope $rootScope</h3><p>$rootScope是所有$scope的上级，相当于全局的$scope<br>$digest更新自身scope和子scope， $apply从$rootScope更新</p>
<h3 id="event"><a href="#event" class="headerlink" title="event"></a>event</h3><p>$emit 向上<br>$broadcast 向下<br>$scope.on() 接收</p>
<h3 id="优化"><a href="#优化" class="headerlink" title="优化"></a>优化</h3><ul>
<li>减少 $watch</li>
<li>ng-if 会卸载dom和$watch， 比ng-show效果好点</li>
<li>减少不必要的$digest $apply</li>
<li>ng-repeat track by</li>
</ul>
</div></article></div></main><footer><div class="paginator"><a href="/2018/02/13/grunt-gulp/" class="prev">PREV</a><a href="/2018/01/14/canvas-path2D-离屏canvas/" class="next">NEXT</a></div><div class="copyright"><p>© 2015 - 2019 <a href="http://yoursite.com">chendong</a>, powered by <a href="https://hexo.io/" target="_blank">Hexo</a> and <a href="https://github.com/pinggod/hexo-theme-apollo" target="_blank">hexo-theme-apollo</a>.</p></div></footer></div><script async src="//cdn.bootcss.com/mathjax/2.7.0/MathJax.js?config=TeX-MML-AM_CHTML" integrity="sha384-crwIf/BuaWM9rM65iM+dWFldgQ1Un8jWZMuh3puxb8TOY9+linwLoI7ZHZT+aekW" crossorigin="anonymous"></script><script>(function(b,o,i,l,e,r){b.GoogleAnalyticsObject=l;b[l]||(b[l]=function(){(b[l].q=b[l].q||[]).push(arguments)});b[l].l=+new Date;e=o.createElement(i);r=o.getElementsByTagName(i)[0];e.src='//www.google-analytics.com/analytics.js';r.parentNode.insertBefore(e,r)}(window,document,'script','ga'));ga('create',"UA-65933410-1",'auto');ga('send','pageview');</script></body></html>